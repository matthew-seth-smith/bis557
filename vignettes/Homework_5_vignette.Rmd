---
title: "Homework 5"
author: "Matthew Smith"
date: "12/14/2018"
output:
  html_document:
    self_contained: yes
    toc: true
---
<!--
%\VignetteEngine{knitr::rmarkdown}
%\VignetteIndexEntry{Deep Learning}
-->

# 1.
In this question, we compare the LASSO to a dense neural network in predicting hand-written characters
in the MNIST data set. For a basis of comparison, we use the code from class for the LASSO procedure.
```{r}
library(keras) #For the MNIST data set
library(glmnet) #For the LASSO
set.seed(1729) #We set the seed so the results are reproducible, using Ramanujan's number as the seed

# The data, shuffled and split between train and test sets
mnist <- dataset_mnist()
x_train <- mnist$train$x
y_train <- mnist$train$y
x_test <- mnist$test$x
y_test <- mnist$test$y

x_train <- array_reshape(x_train, c(60000, 28^2))
x_test <- array_reshape(x_test, c(10000, 28^2))
y_train <- factor(y_train)
y_test <- factor(y_test)

# We only use use 1000 of the characters so that the training and prediction does not take too long
s <- sample(seq_along(y_train), 1000)
fit <- cv.glmnet(x_train[s,], y_train[s], family = "multinomial")
plot(fit)
preds_1 <- predict(fit$glmnet.fit, x_train[s,], s = fit$lambda.min, type = "class") #Using lambda.min
preds_2 <- predict(fit$glmnet.fit, x_train[s,], s = fit$lambda.1se, type = "class") #Using lambda.1se
t_1 <- table(as.vector(preds_1), y_test[s])
t_2 <- table(as.vector(preds_2), y_test[s])
t_1
t_2
# The correct predictions are on the diagonals of these tables
sum(diag(t_1)) / sum(t_2) #0.08917197
sum(diag(t_2)) / sum(t_2) #0.08280255
```
So using the LASSO for a multinomial GLM after converting the images in MNIST into vectors of pixel
intensities provides pretty poor prediction rates. Let's try this now with a dense neural network. We
will use the functions from the textbook *A Computational Approach to Statistical Learning* that I
have included in the `casl-neural-net.R` file in the `R` directory of this package.







# 2. CASL Number 4 in Exercises 8.11
fewf


# 3. CASL Number 8 in Exercises 8.11
dbkgrb